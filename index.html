<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8" />

    <!-- Critical viewport and performance meta tags -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=yes" />
    <meta name="description"
        content="Elevate your event experience! Instantly spend credits for drinks & items directly from your phone." />

    <!-- SEO Meta Tags -->
    <link rel="canonical" href="https://clink.app/" />

    <!-- Open Graph Tags for Social Media -->
    <meta property="og:title" content="Clink - Elevate your event experience" />
    <meta property="og:description"
        content="Elevate your event experience! Instantly spend credits for drinks & items directly from your phone." />
    <meta property="og:image" content="https://clink.app/icons/icon-512x512.png" />
    <meta property="og:url" content="https://clink.app/" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="Clink" />

    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Clink - Elevate your event experience" />
    <meta name="twitter:description"
        content="Elevate your event experience! Instantly spend credits for drinks & items directly from your phone." />
    <!-- Security Headers -->
    <!-- Note: X-Frame-Options, Strict-Transport-Security should be set via HTTP headers, not meta tags -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />

    <!-- Content Security Policy - Tightened for production -->
    <meta http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://fonts.googleapis.com https://accounts.google.com https://www.gstatic.com https://verify.walletconnect.com https://www.googletagmanager.com https://www.google-analytics.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com https://accounts.google.com; img-src 'self' data: blob: https://fonts.gstatic.com https://verify.walletconnect.com https://www.google-analytics.com https://lh3.googleusercontent.com; connect-src 'self' https://fonts.googleapis.com https://fonts.gstatic.com https://api.cdp.coinbase.com https://cca-lite.coinbase.com https://*.coinbase.com https://accounts.google.com https://verify.walletconnect.com wss://clearnet.yellow.com https://mainnet.infura.io https://ethereum.publicnode.com https://cloudflare-eth.com https://www.google-analytics.com https://analytics.google.com https://*.google-analytics.com; frame-src 'self' https://accounts.google.com https://verify.walletconnect.com; child-src 'self' https://accounts.google.com https://verify.walletconnect.com; object-src 'none'; base-uri 'self'; form-action 'self' https://accounts.google.com; font-src 'self' https://fonts.gstatic.com; media-src 'self';" />

    <!-- Permissions Policy to allow popups -->
    <meta http-equiv="Permissions-Policy" content="popup=*, cross-origin-isolated=*, web-share=*" />

    <meta name="theme-color" content="#000" />
    <meta name="color-scheme" content="light" />

    <!-- DNS prefetch for Google Fonts -->
    <link rel="dns-prefetch" href="//fonts.googleapis.com" />
    <link rel="dns-prefetch" href="//fonts.gstatic.com" />

    <!-- Preconnect to Google Fonts for faster loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- Sora font - Async loading to prevent render blocking -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&display=swap"
        as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <noscript>
        <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&display=swap"
            rel="stylesheet" />
    </noscript>

    <!-- Critical CSS inlined for instant render -->
    <style>
        /* Critical app colors - used in onboarding and first render */
        :root {
            --color-base-red: #ffffff;
            --color-base-green: #b6f24e;
            --color-base-green-1: color-mix(in srgb, #b6f24e 20%, transparent);
            --color-base-violet: #9f54fc;
            --color-base-yellow: #ffbb29;
            --color-error: #ff0000;

            --color-secondary: #f24e4e;
            --color-cta: #DF5201;
            --color-cta-1: color-mix(in srgb, #DF5201 50%, transparent);
            --color-cta-2: color-mix(in srgb, #DF5201 35%, transparent);
            --color-cta-3: color-mix(in srgb, #DF5201 25%, transparent);
            --color-cta-4: color-mix(in srgb, #DF5201 15%, transparent);
            --color-cta-5: color-mix(in srgb, #DF5201 8%, transparent);

            --color-shades-100: #ffffff;
            --color-shades-90: #e6e4e4;
            --color-shades-80: #cfcac9;
            --color-shades-70: #b7aead;
            --color-shades-60: #9f9290;
            --color-shades-50: #887674;
            --color-shades-40: #6e5e5c;
            --color-shades-30: #544644;
            --color-shades-20: #392e2c;
            --color-shades-10: #1d1616;
            --color-shades-blur-10: color-mix(in srgb, #1a1a1a 85%, transparent);
            --color-shades-5: #0f0b0b;
            --color-shades-0: #000000;

            /* Viewport height fix for mobile webkit */
            --viewport-height: 100vh;
            --vh: 1vh;
        }

        /* Critical onboarding styles for story progress bars */
        .bg-cta {
            background-color: var(--color-cta);
        }

        .bg-cta-3 {
            background-color: var(--color-cta-3);
        }

        /* Figma-generated story component styles - mobile webkit fix */
        .content-area {
            height: var(--viewport-height);
            position: relative;
            width: 100vw;
        }

        .content-area .overlap {
            height: var(--viewport-height);
            position: relative;
        }

        .content-area .back-gradient-mobile {
            height: var(--viewport-height);
            left: 0;
            overflow: hidden;
            position: absolute;
            top: 0;
            width: 100vw;
        }

        .content-area .wrapper {
            backdrop-filter: blur(20px) brightness(100%);
            align-items: flex-start;
            display: flex;
            flex-direction: column;
            justify-content: center;
            left: 0;
            position: absolute;
            top: 0;
            width: 100vw;
        }

        .content-area .header {
            align-items: center;
            align-self: stretch;
            display: flex;
            flex: 0 0 auto;
            gap: 16px;
            padding: 16px 18px;
            position: relative;
            width: 100%;
        }

        .content-area .frame {
            align-items: flex-start;
            display: flex;
            flex: 1;
            flex-grow: 1;
            gap: 4px;
            position: relative;
        }

        .content-area .text {
            align-items: flex-start;
            display: flex;
            flex-direction: column;
            gap: 11px;
            justify-content: center;
            left: 24px;
            right: 24px;
            position: absolute;
            bottom: 80px;
            width: calc(100vw - 48px);
        }

        .content-area .div-wrapper {
            align-items: center;
            background-color: var(--color-cta-4);
            border: 1px solid var(--color-cta-2);
            border-radius: 30px;
            display: inline-flex;
            flex: 0 0 auto;
            gap: 12px;
            justify-content: center;
            padding: 4px 14px;
            position: relative;
        }

        .content-area .text-wrapper {
            color: var(--color-base-red);
            font-family: "Sora", Helvetica;
            font-size: 13px;
            font-weight: 700;
            letter-spacing: 0.2px;
            line-height: 18px;
            margin-top: -1px;
            position: relative;
            white-space: nowrap;
            width: fit-content;
        }

        .content-area .frame-2 {
            align-items: flex-start;
            align-self: stretch;
            display: flex;
            flex: 0 0 auto;
            flex-direction: column;
            gap: 6px;
            position: relative;
            width: 100%;
        }

        .content-area .text-wrapper-2 {
            align-self: stretch;
            color: var(--color-shades-100);
            font-family: "Sora", Helvetica;
            font-size: 22px;
            font-weight: 700;
            letter-spacing: -0.2px;
            line-height: 28px;
            margin-top: -1px;
            position: relative;
        }

        .content-area .p {
            align-self: stretch;
            color: var(--color-shades-80);
            font-family: "Sora", Helvetica;
            font-size: 15px;
            font-weight: 600;
            letter-spacing: -0.2px;
            line-height: 20px;
            position: relative;
        }

        .content-area .art {
            height: 520px;
            left: 0;
            position: absolute;
            top: 42px;
            width: 100vw;
        }

        .content-area .overlap-group {
            height: 573px;
            left: 50%;
            transform: translateX(-50%);
            position: relative;
            top: -28px;
            width: 260px;
        }

        /* Critical reset and base styles */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        html,
        body {
            margin: 0;
            padding: 0;
            font-family:
                "Sora",
                -apple-system,
                BlinkMacSystemFont,
                "Segoe UI",
                Roboto,
                sans-serif;
            line-height: 1.5;
            font-weight: 400;
            font-size: 14px;
            /* Default for Android */
            color-scheme: light;
            text-rendering: optimizeSpeed;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            min-height: var(--viewport-height);
            background-color: #000;
            color: #f1f5f9;
        }

        #app {
            min-height: var(--viewport-height);
            background-color: #000;
        }

        /* Critical font loading optimization */
        @media (prefers-reduced-motion: no-preference) {
            html {
                scroll-behavior: smooth;
            }
        }

        /* Loading state - mobile webkit fix */
        .app-loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 9999;
            overflow: hidden;
            background-color: #000;
        }

        /* Background component styles */
        .app-loading-background {
            position: absolute;
            inset: 0;
            z-index: 1;
            overflow: hidden;
            height: 100vh;
        }

        .app-loading-background::before {
            content: "";
            position: absolute;
            inset: 0;
            background-color: #000;
        }

        .app-loading-background::after {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: 50%;
            width: 576px;
            height: 576px;
            background-color: var(--color-cta);
            left: 50%;
            transform: translateX(-50%) translateY(150%);
            z-index: 2;
            filter: blur(255px);
            -webkit-filter: blur(255px);
            backdrop-filter: blur(255px);
        }

        /* Loading content */
        .app-loading-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 400px;
            padding: 2rem;
        }

        .app-loading-logo {
            width: 226px;
            max-width: 80vw;
            height: auto;
            opacity: 0;
            animation: logoFadeIn 1s ease-in-out 0.3s forwards;
        }

        .app-loading-title {
            font-weight: 600;
            font-size: 2.25rem;
            /* text-4xl */
            color: var(--color-shades-100);
            margin-top: 1.5rem;
            opacity: 0;
            animation: titleFadeIn 1s ease-in-out 0.8s forwards;
            text-align: center;
        }

        @keyframes logoFadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes titleFadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* App ready state - smooth fade out */
        .app-ready {
            opacity: 0;
            transition: opacity 0.4s ease-out;
            pointer-events: none;
        }

        /* Completely remove loading screen after transition */
        .app-loaded {
            display: none !important;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        /* Critical performance optimizations */
        img,
        video {
            max-width: 100%;
            height: auto;
        }

        /* Eliminate 300ms tap delay */
        *,
        *::before,
        *::after {
            touch-action: manipulation;
        }

        button,
        input,
        select,
        textarea,
        a,
        [role="button"] {
            touch-action: manipulation;
            /* Safari-specific button fixes */
            -webkit-appearance: none;
            appearance: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            /* Ensure buttons are visible and properly styled */
            outline: none;
        }

        /* Fixed positioning Safari compatibility */
        [style*="position:fixed"],
        [style*="position: fixed"] {
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
            will-change: transform;
        }

        /* Button gradient fallbacks for Safari */
        button[style*="linear-gradient"] {
            -webkit-background-size: 100% 100%;
            background-size: 100% 100%;
            background-repeat: no-repeat;
            background-attachment: local;
        }

        /* iPhone specific font size */
        @supports (-webkit-touch-callout: none) {

            /* Safari on iOS */
            html,
            body {
                font-size: 16px;
            }
        }

        /* Critical mobile responsive */
        @media (min-width: 769px) {
            .mobile-only-fallback {
                display: block;
            }

            .mobile-app {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .mobile-only-fallback {
                display: none;
            }

            .mobile-app {
                display: block;
            }
        }
    </style>

    <!-- PWA icons and manifest (optimized) -->
    <link rel="manifest" href="/manifest.webmanifest" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/icons/icon-192x192.png" />

    <title>Clink</title>

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "WebSite",
                "name": "Clink",
                "url": "https://clink.app/",
                "description": "Elevate your event experience! Instantly spend credits for drinks & items directly from your phone.",
                "potentialAction": {
                    "@type": "SearchAction",
                    "target": {
                        "@type": "EntryPoint",
                        "urlTemplate": "https://clink.app/?q={search_term_string}"
                    },
                    "query-input": "required name=search_term_string"
                }
            }
        </script>
    <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "SoftwareApplication",
                "name": "Clink",
                "url": "https://clink.app/",
                "description": "Transform your event experience with Clink's cashless payment solution. Instantly purchase drinks and items using credits loaded directly on your phone. Perfect for festivals, concerts, and events where speed and convenience matter.",
                "applicationCategory": "EventApplication",
                "operatingSystem": "Web",
                "offers": {
                    "@type": "Offer",
                    "price": "0",
                    "priceCurrency": "USD"
                },
                "author": {
                    "@type": "Organization",
                    "name": "Clink"
                }
            }
        </script>

    <!-- PWA icons loaded via JavaScript for true parallel loading -->

    <!-- Preload logo for instant loading screen -->
    <link rel="preload" href="/logo.png" as="image" />

    <!-- Modulepreload for critical app bundle -->
    <link rel="modulepreload" href="/src/main.tsx" />

    <!-- Modulepreload for parallel language file loading -->
    <link rel="modulepreload" href="/src/i18n/translations/en.ts" />
    <link rel="modulepreload" href="/src/i18n/translations/ua.ts" />
    <link rel="modulepreload" href="/src/i18n/translations/fr.ts" />

    <!-- Prefetch non-critical resources -->
    <link rel="prefetch" href="/offline.html" />
</head>

<body>
    <!-- Loading screen overlay -->
    <div id="loading-screen" class="app-loading">
        <div class="app-loading-background"></div>
        <div class="app-loading-content">
            <img src="/logo.png" alt="Clink" class="app-loading-logo" loading="eager" />
            <h1 class="app-loading-title">Clink</h1>
        </div>
    </div>

    <!-- App container -->
    <div id="app"></div>

    <!-- Preload critical JavaScript -->
    <!-- <link rel="modulepreload" href="/src/main.tsx" /> -->

    <!-- Main CSS will be loaded by Vite build system -->

    <!-- CSS loading handled by Vite build system -->

    <!-- Main app script -->
    <script type="module" src="/src/main.tsx"></script>

    <!-- Load non-critical CSS asynchronously -->
    <script>
        // Async CSS loader for better performance
        function loadCSS(href, media) {
            const link = document.createElement("link");
            link.rel = "stylesheet";
            link.href = href;
            link.media = media || "print";
            link.onload = function () {
                this.media = "all";
            };
            link.onerror = function () {
                this.media = "all"; // Fallback on error
            };
            document.head.appendChild(link);
            return link;
        }

        // App loading state management
        (function () {
            const loadingScreen = document.getElementById("loading-screen");
            let isTransitioning = false;

            // Function to hide loading screen smoothly
            function hideLoadingScreen() {
                if (loadingScreen && !isTransitioning) {
                    isTransitioning = true;

                    // Wait a moment to ensure app content is ready
                    setTimeout(() => {
                        // Start fade out transition
                        loadingScreen.classList.add("app-ready");

                        // After transition completes, fully remove loading overlay
                        setTimeout(() => {
                            loadingScreen.classList.add("app-loaded");
                        }, 400); // Match transition duration
                    }, 150); // Brief delay to ensure smooth transition
                }
            }

            // Hide loading screen when React app is ready
            window.addEventListener("app-mounted", () => {
                // Ensure minimum loading time for smooth experience
                setTimeout(hideLoadingScreen, 200);
            });

            // Fallback: hide after maximum time
            setTimeout(() => {
                if (loadingScreen && !isTransitioning) {
                    hideLoadingScreen();
                }
            }, 4000); // 4 second fallback
        })();

        // Load non-critical styles during idle time
        if ("requestIdleCallback" in window) {
            requestIdleCallback(
                () => {
                    // Ensure Google Fonts are loaded as fallback
                    const fontLink = document.querySelector('link[href*="fonts.googleapis.com"]');
                    if (fontLink && fontLink.rel !== "stylesheet") {
                        const fallbackLink = document.createElement("link");
                        fallbackLink.rel = "stylesheet";
                        fallbackLink.href =
                            "https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&display=swap";
                        document.head.appendChild(fallbackLink);
                    }
                },
                { timeout: 500 },
            );
        }
    </script>

    <!-- Parallel image loading for true parallelism - moved early for immediate execution -->
    <script>
        // Parallel image loading for true parallelism
        (function loadImagesInParallel() {
            const imageUrls = ["/favicon.ico", "/icons/icon-192x192.png", "/icons/icon-512x512.png"];

            // Create all image objects simultaneously for parallel loading
            const imagePromises = imageUrls.map((url) => {
                return new Promise((resolve, reject) => {
                    const img = new Image();
                    img.onload = () => {
                        console.log(`‚úì Loaded: ${url}`);
                        resolve(url);
                    };
                    img.onerror = () => reject(new Error(`Failed to load ${url}`));
                    img.src = url; // This triggers the parallel request
                });
            });

            // Wait for all images to load in parallel
            Promise.all(imagePromises)
                .then(() => {
                    console.log("üöÄ All PWA icons loaded in parallel");
                })
                .catch((error) => {
                    console.warn("‚ö†Ô∏è Some PWA icons failed to load:", error);
                });
        })();

        // Service worker registration now handled manually in main.tsx with requestIdleCallback
    </script>

    <!-- Service worker registration now deferred to requestIdleCallback in main.tsx -->
</body>

</html>